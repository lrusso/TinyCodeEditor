<!DOCTYPE html>
<html class="header_html" lang="en">
	<head>
		<meta charset="UTF-8">
		<title>TinyACE Editor</title>
		<link rel="stylesheet" href="tinyACE.css" type="text/css">
		<style>
			html,body{height:100%;margin:0;padding:0;background-color:white;}
			body{background:url("tinyACE.gif") no-repeat center center;}
		</style>
	</head>
	<body>
		<script>
			var userLanguage = window.navigator.userLanguage || window.navigator.language;
			var STRING_FILENAME = "";
			var STRING_FILENAME_EMPTY = "";
			var STRING_NEW_QUESTION = "";
			var STRING_WELCOME = "";
			if (userLanguage.substring(0,2)=="es")
				{
				STRING_FILENAME = "Sin nombre.htm";
				STRING_FILENAME_EMPTY = "Sin nombre";
				STRING_NEW_QUESTION = "\u00BFPerder cualquier cambio no guardado?";
				STRING_WELCOME = "<!DOCTYPE html>\n<html lang=\"es\">\n" + String.fromCharCode(9) + "<head>\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<meta charset=\"UTF-8\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<link rel=\"stylesheet\" href=\"estilos.css\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<title>Bienvenido a TinyACE Editor (basado en Ace Code Editor) por Leonardo Russo / www.lrusso.com</title>\n" + String.fromCharCode(9) + "</head>\n" + String.fromCharCode(9) + "<body>\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<form action=\"ejemplo.htm\" method=\"GET\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + String.fromCharCode(9) + "<input type=\"text\" value=\"TEXTO DE PRUEBA\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + String.fromCharCode(9) + "<input type=\"submit\" value=\"INGRESAR\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + "</form>\n" + String.fromCharCode(9) + "</body>\n</html>";
				}
				else
				{
				STRING_FILENAME = "Untitled.htm";
				STRING_FILENAME_EMPTY = "Untitled";
				STRING_NEW_QUESTION = "Lose any unsaved changes?";
				STRING_WELCOME = "<!DOCTYPE html>\n<html lang=\"en\">\n" + String.fromCharCode(9) + "<head>\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<meta charset=\"UTF-8\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<link rel=\"stylesheet\" href=\"styles.css\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<title>Welcome to TinyACE Editor (based on Ace Code Editor) by Leonardo Russo / www.lrusso.com</title>\n" + String.fromCharCode(9) + "</head>\n" + String.fromCharCode(9) + "<body>\n" + String.fromCharCode(9) + String.fromCharCode(9) + "<form action=\"example.htm\" method=\"GET\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + String.fromCharCode(9) + "<input type=\"text\" value=\"TEST TEXT\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + String.fromCharCode(9) + "<input type=\"submit\" value=\"ENTER\">\n" + String.fromCharCode(9) + String.fromCharCode(9) + "</form>\n" + String.fromCharCode(9) + "</body>\n</html>";
				}
		</script>

		<div id="tinyace_fullscreener">
			<div class="tinyace_menubar">
				<div class="tinyace_holder">
					<div class="tinyace_button_new_enabled" id="buttonNew"></div>
				</div>
				<div class="tinyace_holder">
					<div class="tinyace_button_open_enabled" id="buttonOpen"></div>
					<input type="file" class="tinyace_buttonHidden" id="fileOpener" onChange="menuOpenFile(document.getElementById('fileOpener').files[0]);">
				</div>
				<div class="tinyace_holder">
					<div class="tinyace_button_save_enabled" id="buttonSave"></div>
				</div>
				<div class="tinyace_separator"></div>
				<div class="tinyace_holder">
					<div class="tinyace_button_undo_disabled" id="buttonUndo"></div>
				</div>
				<div class="tinyace_holder">
					<div class="tinyace_button_redo_disabled" id="buttonRedo"></div>
				</div>
				<div class="tinyace_separator"></div>
				<div class="tinyace_holder">
					<div class="tinyace_button_search_enabled" id="buttonSearch"></div>
				</div>
				<div class="tinyace_holder">
					<div class="tinyace_button_fullscreen_disabled" id="buttonFullScreen"></div>
				</div>
				<div class="tinyace_separator"></div>
				<div class="tinyace_holder">
					<div class="tinyace_dropdown">
						<div class="tinyace_dropdown_button" id="tinyace_language">HTML</div>
						<div id="myDropdown" class="tinyace_dropdown_content">
							<span onclick="menuLanguage('html')">HTML</span>
							<span onclick="menuLanguage('javascript')">JavaScript</span>
							<span onclick="menuLanguage('css')">CSS</span>
							<span onclick="menuLanguage('java')">Java</span>
							<span onclick="menuLanguage('php')">PHP</span>
							<span onclick="menuLanguage('xml')">XML</span>
							<span onclick="menuLanguage('c')">C / C++</span>
							<span onclick="menuLanguage('arduino')">Arduino</span>
						</div>
					</div>
				</div>
				<div class="tinyace_holder">
					<div id="tinyace_filename"><script>document.write(STRING_FILENAME_EMPTY + ".htm");</script></div>
				</div>
			</div>
			<div id="tinyace_textcode_container"><div id="tinyace_textcode"></div></div>
		</div>

		<script src="tinyACE.js"></script>
		<script>

			document.getElementById("tinyace_filename").innerHTML = STRING_FILENAME;

			ace.config.set("basePath",".");
			var editor = ace.edit("tinyace_textcode");
			editor.setOptions({fontSize:"14px",showPrintMargin:false,showInvisibles:true,tabSize:4,useSoftTabs:false,highlightActiveLine:false});
			editor.commands.removeCommand("gotoline");
			editor.session.setMode("ace/mode/html");
			editor.setTheme("ace/theme/monokai");
			editor.session.setUseWorker(false);
			editor.setValue(STRING_WELCOME);
			editor.clearSelection();
			editor.selection.moveTo(0,0);
			editor.session.getUndoManager().reset();
			editor.focus();
			editor.getSession().on("change", function()
				{
				window.onbeforeunload = function(e){return "changed";};
				document.getElementById("buttonUndo").classList.add("tinyace_button_undo_enabled");
				document.getElementById("buttonUndo").classList.remove("tinyace_button_undo_disabled");
				});

			function menuNewFile()
				{
				var message = true;

				if (!editor.session.getUndoManager().isClean())
					{
					message = confirm(STRING_NEW_QUESTION);
					}

				if (message == true)
					{
					STRING_FILENAME = STRING_FILENAME_EMPTY + ".htm";
					document.getElementById("tinyace_filename").innerHTML = STRING_FILENAME;
					document.getElementById("tinyace_language").innerHTML = "HTML";
					editor.setValue("");
					editor.session.setMode("ace/mode/html");
					editor.clearSelection();
					editor.selection.moveTo(0,0);
					editor.session.getUndoManager().reset();
					document.getElementById("buttonUndo").classList.add("tinyace_button_undo_disabled");
					document.getElementById("buttonUndo").classList.remove("tinyace_button_undo_enabled");
					document.getElementById("buttonRedo").classList.add("tinyace_button_redo_disabled");
					document.getElementById("buttonRedo").classList.remove("tinyace_button_redo_enabled");
					try{editor.searchBox.hide();}catch(err){}
					window.onbeforeunload = null;
					}

				try
					{
					editor.focus();
					}
					catch(err)
					{
					}
				}

			function menuOpenFile(file)
				{
				var message = true;

				if (!editor.session.getUndoManager().isClean())
					{
					message = confirm(STRING_NEW_QUESTION);
					}

				if (message == true)
					{
					var filereader = new FileReader();
					filereader.file_name = file.name;
					STRING_FILENAME = file.name;
					var extension = filereader.file_name.split(".").pop().toLowerCase();
					filereader.onload = function()
						{
						var content = this.result;
						document.getElementById("tinyace_filename").innerHTML = STRING_FILENAME;

						var newLanguage;
						var selectedLanguage;

						if (extension=="htm" || extension=="html")		{newLanguage = "HTML";selectedLanguage="html";}
						else if (extension=="js")						{newLanguage = "JavaScript";selectedLanguage="javascript";}
						else if (extension=="css")						{newLanguage = "CSS";selectedLanguage="css";}
						else if (extension=="java")						{newLanguage = "Java";selectedLanguage="java";}
						else if (extension=="php")						{newLanguage = "PHP";selectedLanguage="php";}
						else if (extension=="xml")						{newLanguage = "XML";selectedLanguage="xml";}
						else if (extension=="c")						{newLanguage = "C";selectedLanguage="c_cpp";}
						else if (extension=="ino")						{newLanguage = "Arduino";selectedLanguage="c_cpp";}
						else											{newLanguage = "HTML";selectedLanguage="html";}

						document.getElementById("tinyace_language").innerHTML = newLanguage;

						editor.session.setMode("ace/mode/" + selectedLanguage);

						editor.setValue(content);
						editor.clearSelection();
						editor.selection.moveTo(0,0);
						editor.session.getUndoManager().reset();
						document.getElementById("buttonUndo").classList.add("tinyace_button_undo_disabled");
						document.getElementById("buttonUndo").classList.remove("tinyace_button_undo_enabled");
						document.getElementById("buttonRedo").classList.add("tinyace_button_redo_disabled");
						document.getElementById("buttonRedo").classList.remove("tinyace_button_redo_enabled");
						try{editor.searchBox.hide();}catch(err){}
						window.onbeforeunload = null;
						editor.scrollToLine(0,true,true,function(){});
						editor.focus();
						};
					filereader.readAsText(file,"ISO-8859-1");
					}
				document.getElementById("fileOpener").value = null;
				};

			function menuSaveFile()
				{
				var blobValue = new Blob([editor.getValue()],{type:"text/plain"});
				var filename = STRING_FILENAME;
				var link = document.createElement("a");
				link.style.display = "none";
				document.body.appendChild(link);
				link.href = URL.createObjectURL(blobValue);
				link.download = filename || "data.json";
				link.click();

				try
					{
					editor.session.getUndoManager().reset();
					document.getElementById("buttonUndo").classList.add("tinyace_button_undo_disabled");
					document.getElementById("buttonUndo").classList.remove("tinyace_button_undo_enabled");
					document.getElementById("buttonRedo").classList.add("tinyace_button_redo_disabled");
					document.getElementById("buttonRedo").classList.remove("tinyace_button_redo_enabled");
					try{editor.searchBox.hide();}catch(err){}
					window.onbeforeunload = null;
					editor.focus();
					}
					catch(err)
					{
					}
				}

			function menuSearch()
				{
				try
					{
					editor.execCommand("find");
					}
					catch(err)
					{
					}
				}

			function menuUndo()
				{
				try
					{
					editor.undo();
					editor.focus();
					editor.clearSelection();
					if (!editor.session.getUndoManager().hasUndo())
						{
						document.getElementById("buttonUndo").classList.add("tinyace_button_undo_disabled");
						document.getElementById("buttonUndo").classList.remove("tinyace_button_undo_enabled");
						}
					if (editor.session.getUndoManager().hasRedo())
						{
						document.getElementById("buttonRedo").classList.add("tinyace_button_redo_enabled");
						document.getElementById("buttonRedo").classList.remove("tinyace_button_redo_disabled");
						}
					}
					catch(err)
					{
					}
				}

			function menuRedo()
				{
				try
					{
					editor.redo();
					editor.focus();
					editor.clearSelection();
					if (!editor.session.getUndoManager().hasRedo())
						{
						document.getElementById("buttonRedo").classList.add("tinyace_button_redo_disabled");
						document.getElementById("buttonRedo").classList.remove("tinyace_button_redo_enabled");
						}
					if (editor.session.getUndoManager().hasUndo())
						{
						document.getElementById("buttonUndo").classList.add("tinyace_button_undo_enabled");
						document.getElementById("buttonUndo").classList.remove("tinyace_button_undo_disabled");
						}
					}
					catch(err)
					{
					}
				}

			function menuLanguage(selectedLanguage)
				{
				try
					{
					var changeFileName = STRING_FILENAME.indexOf(STRING_FILENAME_EMPTY + ".");

					var selectedExtension = "";
					var selectedLanguageLabel = "";
					if (selectedLanguage=="html")				{selectedExtension=".htm";selectedLanguageLabel="HTML";}
					else if (selectedLanguage=="javascript")	{selectedExtension=".js";selectedLanguageLabel="JavaScript";}
					else if (selectedLanguage=="css")			{selectedExtension=".css";selectedLanguageLabel="CSS";}
					else if (selectedLanguage=="java")			{selectedExtension=".java";selectedLanguageLabel="Java";}
					else if (selectedLanguage=="php")			{selectedExtension=".php";selectedLanguageLabel="PHP";}
					else if (selectedLanguage=="xml")			{selectedExtension=".xml";selectedLanguageLabel="XML";}
					else if (selectedLanguage=="c")				{selectedExtension=".c";selectedLanguage="c_cpp";selectedLanguageLabel="C";}
					else if (selectedLanguage=="arduino")		{selectedExtension=".ino";selectedLanguage="c_cpp";selectedLanguageLabel="Arduino";}
					if (changeFileName>-1){STRING_FILENAME = STRING_FILENAME_EMPTY + selectedExtension;}

					document.getElementById("tinyace_filename").innerHTML = STRING_FILENAME;
					document.getElementById("tinyace_language").innerHTML = selectedLanguageLabel;

					editor.session.setMode("ace/mode/" + selectedLanguage);
					editor.focus();
					}
					catch(err)
					{
					}
				}

			function menuFullScreen()
				{
				if (document.getElementById("tinyace_fullscreener").style.position!="absolute")
					{
					document.getElementById("tinyace_fullscreener").style.position="absolute";
					document.getElementById("tinyace_fullscreener").style.left="0px";
					document.getElementById("tinyace_fullscreener").style.top="0px";
					document.getElementById("tinyace_fullscreener").style.right="0px";
					document.getElementById("tinyace_fullscreener").style.bottom="0px";
					document.getElementById("buttonFullScreen").classList.add("tinyace_button_fullscreen_enabled");
					}
					else
					{
					document.getElementById("tinyace_fullscreener").style.position="inherit";
					document.getElementById("tinyace_fullscreener").style.left="0px";
					document.getElementById("tinyace_fullscreener").style.top="0px";
					document.getElementById("tinyace_fullscreener").style.right="0px";
					document.getElementById("tinyace_fullscreener").style.bottom="0px";
					document.getElementById("buttonFullScreen").classList.remove("tinyace_button_fullscreen_enabled");
					}
				resizeTinyCodeEditor();
				editor.focus();
				}

			function focusEditor()
				{
				try
					{
					editor.focus();
					}
					catch(err)
					{
					}
				}

			function resizeTinyCodeEditor()
				{
				var w = window, d = document, e = d.documentElement, g = d.getElementsByTagName("body")[0], x = w.innerWidth || e.clientWidth || g.clientWidth, y = w.innerHeight|| e.clientHeight|| g.clientHeight;
				var editHeight;
				if (document.getElementById("tinyace_fullscreener").style.position!="absolute")
					{
					editHeight = y - 41; // OR SOME VALUE THAT YOU WANT WHEN NOT FULLSCREEN
					}
					else
					{
					editHeight = y - 41; // OR SOME VALUE THAT YOU WANT WHEN FULLSCREEN
					}

				document.getElementById("tinyace_textcode_container").style.height = editHeight.toString() + "px";
				editor.resize();
				editor.focus();
				};

			function showDropDownMenu()
				{
				document.getElementById("myDropdown").classList.toggle("tinyace_dropdown_show");
				}

			window.onresize = function()
				{
				resizeTinyCodeEditor();
				};

			window.onload = function()
				{
				resizeTinyCodeEditor();
				document.getElementById("buttonNew").addEventListener("click",function(event){menuNewFile()});
				document.getElementById("buttonOpen").addEventListener("click",function(event){editor.focus();document.getElementById("fileOpener").click();});
				document.getElementById("buttonSave").addEventListener("click",function(event){menuSaveFile()});
				document.getElementById("buttonUndo").addEventListener("click",function(event){menuUndo()});
				document.getElementById("buttonRedo").addEventListener("click",function(event){menuRedo()});
				document.getElementById("buttonSearch").addEventListener("click",function(event){menuSearch()});
				document.getElementById("buttonFullScreen").addEventListener("click",function(event){menuFullScreen()});
				document.getElementById("tinyace_language").addEventListener("click",function(event){showDropDownMenu()});
				document.getElementById("tinyace_filename").addEventListener("click",function(event){editor.focus()});
				};

			window.onclick = function(event)
				{
				if (!event.target.matches(".tinyace_dropdown_button"))
					{
					var dropdowns = document.getElementsByClassName("tinyace_dropdown_content");
					for (var i = 0; i < dropdowns.length; i++)
						{
						var openDropdown = dropdowns[i];
						if (openDropdown.classList.contains("tinyace_dropdown_show"))
							{
							openDropdown.classList.remove("tinyace_dropdown_show");
							editor.focus();
							setTimeout(function(){editor.focus();},200);
							}
						}
					}
				}
		</script>
	</body>
</html>